{% extends "base.html.twig" %}

{% block title %}PABBA -
	{{ event.title }}
{% endblock %}

{% block body %}

	<div style="width:80%;margin:auto;margin-top:30px;">

		<div class="row">
			<div class="col-4">
				<div class="card p-3">
					{% if app.user in event.organisers %}
						<div class="col-5 offset-7">
							<a href="{{ path('event_update', { 'id' : event.id}) }}" class="btn btn-edit-event w-100">
								<i class="fas fa-edit"></i>
								Editer</a>
						</div>
					{% endif %}
					<img src="{{ (event.imageName) ? vich_uploader_asset(event, 'imageFile') : asset('images/default_event.png') }}" alt="Image de l'évènement {{ event.title }}" class="w-100">

					<p class="show-event-title">Informations</p>

					{% if isToday(event.eventAt) == 1 %}

						<p>Aura lieu le :
							<i>{{ event.eventAt | date('d/m/Y') }}</i>
							à
							<i>{{ event.eventAt | date('H:i') }}</i>
							{% if app.user in event.participants %}
								<span class="badge badge-pill badge-success">
									<i class="fas fa-check"></i>
									J'y participe</span>
							{% endif %}
						</p>

					{% elseif isToday(event.eventAt) == 2 %}

						<p>A eu lieu le :
							<i>{{ event.eventAt | date('d/m/Y') }}</i>
							à
							<i>{{ event.eventAt | date('H:i') }}</i>
							{% if app.user in event.participants %}
								<span class="badge badge-pill badge-success">
									<i class="fas fa-check"></i>
									J'y participe</span>
							{% endif %}
						</p>

					{% else %}

						<p>A lieu aujourd'hui à
							<i>{{ event.eventAt | date('H:i') }}</i>
							{% if app.user in event.participants %}
								<span class="badge badge-pill badge-success">
									<i class="fas fa-check"></i>
									J'y participe</span>
							{% endif %}
						</p>

					{% endif %}


					<a target="_blank" href="https://www.google.com/maps/search/?api=1&query={{ event.place.address|url_encode }}" class="text-decoration-none event-place show-event-text">
						{{ event.place.address }}
					</a>

					<p>
						<span class="badge badge-pill badge-event-show">{{ event.eventType.label | capitalize }}</span>
					</p>


					{% if app.user in event.participants %}
						<a href="{{ path('event_quit', { 'event' : event.id } ) }}" class="btn btn-quit-event col-4 mb-3">
							<i class="fas fa-sign-out-alt"></i>
							Quitter</a>
					{% else %}
						<a href="{{ path('event_join', { 'event' : event.id } ) }}" class="btn btn-primary btn-join-event col-4 mb-3">
							<i class="fas fa-sign-in-alt"></i>
							Rejoindre</a>
					{% endif %}


					<p class="show-event-title">Description</p>

					<p class="show-event-text">
						{{ event.description }}
					</p>


				</div>
			</div>

			<div class="col-8">

				<div class="card">

					<ul class="nav nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
						<li class="nav-item" role="presentation">
							<a class="nav-link active" id="news-tab" data-toggle="pill" href="#news" role="tab" aria-controls="news" aria-selected="false">Actualités</a>
						</li>
						<li class="nav-item" role="presentation">
							<a class="nav-link" id="participants-tab" data-toggle="pill" href="#participants" role="tab" aria-controls="participants" aria-selected="true">Participants</a>
						</li>
					</ul>

					<div
						class="tab-content p-4" id="pills-tabContent">

						{# Onglet des actualités et commentaires #}
						<div class="tab-pane fade show active" id="news" role="tabpanel" aria-labelledby="news-tab">

							<div
								class="row justify-content-center">
								{# Mettre le PATH vers la création d'un commentaire/actualité #}
								<a href="" class="btn add-btn-event-comment">
									<i class="bi bi-plus-circle-fill"></i>
								</a>
							</div>

							<div
								class="row justify-content-center">
								{# {% for comment in event.comments %} #}
								{% if false == true %}
									{# Ici gérer l'affichage des commentaires #}
									blabla
								{% else %}
									<p class="no-result">Il n'y a rien à afficher ici !</p>
								{% endif %}
								{# {% endfor %} #}
							</div>

						</div>

						{# Onglet des participants #}
						<div class="tab-pane fade" id="participants" role="tabpanel" aria-labelledby="participants-tab">

							<div class="row row-cols-2 justify-content-center">
								{% for participant in event.participants %}

									<div class="col-6 mb-4">
										<div class="card rounded">
											<div
												class="row no-gutters {{ (participant in event.organisers) ? '' : 'align-items-center' }}">
												{# <div class="col-3"> #}
												<img
												src="{{ asset('/images/default_profile.jpg') }}" class="rounded-circle col-2 p-2" alt="Photo de profil de {{ participant.firstname }}">
												{# </div> #}
												<div class="col-9 align-self-center">
													<div class="col-12 event-participant">
														{{ participant.firstname | capitalize ~ ' ' ~ participant.lastname | capitalize }}
													</div>
													<div class="col-12">
														{% if participant in event.organisers %}
															<span class="badge badge-pill badge-event-show">Organisateur</span>

														{% endif %}
														{% if participant == event.place.user %}
															<span class="badge badge-pill badge-event-show">Manager du jardin</span>
														{% endif %}
													</div>
												</div>
											</div>
										</div>
									</div>


								{% else %}
									<p class="no-result">Il n'y a aucun participants !</p>
								{% endfor %}
							</div>

						</div>

					</div>


				</div>

			</div>
		</div>

	</div>

{% endblock %}
